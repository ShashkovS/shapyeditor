const pythonValidationUrl=location.origin+"/s/aceMods/python-validation.min.js";console.warn("Worker validator start");const eventDataSaver={data:null};!function(t){if(void 0!==t.window&&t.document)return;if(t.require&&t.define)return;t.console||(t.console=function(){const t=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:t})},t.console.error=t.console.warn=t.console.log=t.console.trace=t.console),t.window=t,t.ace=t,t.onerror=function(t,e,n,i,s){postMessage({type:"error",data:{message:t,data:s.data,file:e,line:n,col:i,stack:s.stack}})},t.normalizeModule=function(e,n){if(-1!==n.indexOf("!")){const i=n.split("!");return`${t.normalizeModule(e,i[0])}!${t.normalizeModule(e,i[1])}`}if("."===n.charAt(0)){const t=e.split("/").slice(0,-1).join("/");let i;for(n=(t?`${t}/`:"")+n;-1!==n.indexOf(".")&&i!==n;)i=n,n=n.replace(/^\.\//,"").replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return n},t.require=function(e,n){if(n||(n=e,e=null),!n.charAt)throw new Error("worker.js require() accepts only (parentId, id) as arguments");n=t.normalizeModule(e,n);const i=t.require.modules[n];if(i)return i.initialized||(i.initialized=!0,i.exports=i.factory().exports),i.exports;if(!t.require.tlns)return console.log(`unable to load ${n}`);let s=function(t,e){let n=t,i="";for(;n;){const t=e[n];if("string"==typeof t)return t+i;if(t)return t.location.replace(/\/*$/,"/")+(i||t.main||t.name);if(!1===t)return"";const s=n.lastIndexOf("/");if(-1===s)break;i=n.substr(s)+i,n=n.slice(0,s)}return t}(n,t.require.tlns);return".js"!==s.slice(-3)&&(s+=".js"),t.require.id=n,t.require.modules[n]={},importScripts(s),t.require(e,n)},t.require.modules={},t.require.tlns={},t.define=function(e,n,i){if(2===arguments.length?(i=n,"string"!=typeof e&&(n=e,e=t.require.id)):1===arguments.length&&(i=e,n=[],e=t.require.id),"function"!=typeof i)return void(t.require.modules[e]={exports:i,initialized:!0});n.length||(n=["require","exports","module"]);const s=function(n){return t.require(e,n)};t.require.modules[e]={exports:{},factory(){const t=this,e=i.apply(this,n.slice(0,i.length).map(e=>{switch(e){case"require":return s;case"exports":return t.exports;case"module":return t;default:return s(e)}}));return e&&(t.exports=e),t}}},t.define.amd={},require.tlns={},t.initBaseUrls=function(t){for(const e in t)require.tlns[e]=t[e]},t.initSender=function(){const{EventEmitter:e}=t.require("ace/lib/event_emitter"),n=t.require("ace/lib/oop"),i=function(){};return function(){n.implement(this,e),this.emit=function(t,e){postMessage({type:"event",name:t,data:e})}}.call(i.prototype),new i};let e=t.main=null,n=t.sender=null;t.onmessage=function(i){eventDataSaver.data=i.data;const s=i.data;if(s.event&&n)n._signal(s.event,s.data);else if(s.command)if(e[s.command])e[s.command].apply(e,s.args);else{if(!t[s.command])throw new Error(`Unknown command:${s.command}`);t[s.command].apply(t,s.args)}else if(s.init){t.initBaseUrls(s.tlns),n=t.sender=t.initSender();const i=require(s.module)[s.classname];e=t.main=new i(n)}}}(this),ace.define("ace/lib/oop",[],(t,e,n)=>{"use strict";e.inherits=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},e.mixin=function(t,e){for(const n in e)t[n]=e[n];return t},e.implement=function(t,n){e.mixin(t,n)}}),ace.define("ace/range",[],(t,e,n)=>{"use strict";const i=function(t,e,n,i){this.start={row:t,column:e},this.end={row:n,column:i}};(function(){}).call(i.prototype),i.comparePoints=function(t,e){return t.row-e.row||t.column-e.column},e.Range=i}),ace.define("ace/apply_delta",[],(t,e,n)=>{"use strict";e.applyDelta=function(t,e,n){const{row:i}=e.start,s=e.start.column,r=t[i]||"";switch(e.action){case"insert":const{lines:n}=e;if(1===n.length)t[i]=r.substring(0,s)+e.lines[0]+r.substring(s);else{const n=[i,1].concat(e.lines);t.splice.apply(t,n),t[i]=r.substring(0,s)+t[i],t[i+e.lines.length-1]+=r.substring(s)}break;case"remove":const o=e.end.column,a=e.end.row;i===a?t[i]=r.substring(0,s)+r.substring(o):t.splice(i,a-i+1,r.substring(0,s)+t[a].substring(o))}}}),ace.define("ace/lib/event_emitter",[],(t,e,n)=>{"use strict";const i={};i._emit=i._signal=function(t,e){let n=(this._eventRegistry||{})[t];if(n){n=n.slice();for(let t=0;t<n.length;t++)n[t](e,this)}},i.on=i.addEventListener=function(t,e,n){this._eventRegistry=this._eventRegistry||{};let i=this._eventRegistry[t];return i||(i=this._eventRegistry[t]=[]),-1==i.indexOf(e)&&i[n?"unshift":"push"](e),e},i.off=i.removeListener=e.EventEmitter=i}),ace.define("ace/anchor",[],(t,e,n)=>{"use strict";const i=t("./lib/oop"),{EventEmitter:s}=t("./lib/event_emitter"),r=e.Anchor=function(t,e,n){this.$onChange=this.onChange.bind(this),this.attach(t),void 0===n?this.setPosition(e.row,e.column):this.setPosition(e,n)};(function(){i.implement(this,s)}).call(r.prototype)}),ace.define("ace/document",[],(t,e,n)=>{"use strict";const i=t("./lib/oop"),{applyDelta:s}=t("./apply_delta"),{EventEmitter:r}=t("./lib/event_emitter"),{Range:o}=t("./range"),a=function(t){this.$lines=[""],0===t.length?this.$lines=[""]:Array.isArray(t)?this.insertMergedLines({row:0,column:0},t):this.insert({row:0,column:0},t)};(function(){i.implement(this,r),this.setValue=function(t){const e=this.getLength()-1;this.remove(new o(0,0,e,this.getLine(e).length)),this.insert({row:0,column:0},t)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},0==="aaa".split(/a/).length?this.$split=function(t){return t.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(t){return t.split(/\r\n|\r|\n/)},this.$detectNewLine=function(t){const e=t.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=e?e[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.getLine=function(t){return this.$lines[t]||""},this.getLines=function(t,e){return this.$lines.slice(t,e+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getLinesForRange=function(t){let e;if(t.start.row===t.end.row)e=[this.getLine(t.start.row).substring(t.start.column,t.end.column)];else{e=this.getLines(t.start.row,t.end.row),e[0]=(e[0]||"").substring(t.start.column);const n=e.length-1;t.end.row-t.start.row===n&&(e[n]=e[n].substring(0,t.end.column))}return e},this.insert=function(t,e){return this.getLength()<=1&&this.$detectNewLine(e),this.insertMergedLines(t,this.$split(e))},this.clippedPos=function(t,e){const n=this.getLength();void 0===t?t=n:t<0?t=0:t>=n&&(t=n-1,e=void 0);const i=this.getLine(t);return void 0===e&&(e=i.length),{row:t,column:e=Math.min(Math.max(e,0),i.length)}},this.clonePos=function(t){return{row:t.row,column:t.column}},this.pos=function(t,e){return{row:t,column:e}},this.insertMergedLines=function(t,e){const n=this.clippedPos(t.row,t.column),i={row:n.row+e.length-1,column:(1===e.length?n.column:0)+e[e.length-1].length};return this.applyDelta({start:n,end:i,action:"insert",lines:e}),this.clonePos(i)},this.remove=function(t){const e=this.clippedPos(t.start.row,t.start.column),n=this.clippedPos(t.end.row,t.end.column);return this.applyDelta({start:e,end:n,action:"remove",lines:this.getLinesForRange({start:e,end:n})}),this.clonePos(e)},this.applyDeltas=function(t){for(let e=0;e<t.length;e++)this.applyDelta(t[e])},this.applyDelta=function(t,e){const n="insert"===t.action;(n?t.lines.length<=1&&!t.lines[0]:!o.comparePoints(t.start,t.end))||(n&&t.lines.length>2e4?this.$splitAndapplyLargeDelta(t,2e4):(s(this.$lines,t,e),this._signal("change",t)))},this.$splitAndapplyLargeDelta=function(t,e){const{lines:n}=t,i=n.length-e+1,{row:s}=t.start;let{column:r}=t.start;for(let o=0,a=0;o<i;o=a){a+=e-1;const i=n.slice(o,a);i.push(""),this.applyDelta({start:this.pos(s+o,r),end:this.pos(s+a,r=0),action:t.action,lines:i},!0)}t.lines=n.slice(from),t.start.row=s+from,t.start.column=r,this.applyDelta(t,!0)}}).call(a.prototype),e.Document=a}),ace.define("ace/lib/lang",[],(t,e,n)=>{"use strict";e.delayedCall=function(t,e){let n=null;const i=function(){n=null,t()},s=function(t){null==n&&(n=setTimeout(i,t||e))};return s.delay=function(t){n&&clearTimeout(n),n=setTimeout(i,t||e)},s.schedule=s,s.call=function(){this.cancel(),t()},s.cancel=function(){n&&clearTimeout(n),n=null},s.isPending=function(){return n},s}}),ace.define("ace/worker/mirror",[],(t,e,n)=>{"use strict";const{Range:i}=t("../range"),{Document:s}=t("../document"),r=t("../lib/lang"),o=e.Mirror=function(t){this.sender=t;const e=this.doc=new s(""),n=this.deferredUpdate=r.delayedCall(this.onUpdate.bind(this)),i=this;t.on("change",t=>{const{data:s}=t;if(s[0].start)e.applyDeltas(s);else for(let t=0;t<s.length;t+=2){let n;n=Array.isArray(s[t+1])?{action:"insert",start:s[t],lines:s[t+1]}:{action:"remove",start:s[t],end:s[t+1]},e.applyDelta(n,!0)}if(i.$timeout)return n.schedule(i.$timeout);i.onUpdate()})};(function(){this.$timeout=500,this.setTimeout=function(t){this.$timeout=t},this.setValue=function(t){this.doc.setValue(t),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(t){this.sender.callback(this.doc.getValue(),t)},this.onUpdate=function(){}}).call(o.prototype)}),importScripts(pythonValidationUrl),ace.define("ace/mode/python_worker",[],(t,e,n)=>{"use strict";const i=t("../lib/oop"),{Mirror:s}=t("../worker/mirror"),r=e.PythonWorker=function(t){s.call(this,t),this.setTimeout(500)};i.inherits(r,s),function(){this.onUpdate=function(){if(!eventDataSaver.data||!eventDataSaver.data.data)return void this.sender.emit("ok");const t=eventDataSaver.data.data.data[0].row,e=pythonValidation(this.doc.getValue(),t);e.length?this.sender.emit("error",e):this.sender.emit("ok")}}.call(r.prototype)});